<!DOCTYPE html>
<html>
<head>
	<title>Minesweeper</title>
</head>
<body>

<h1>Coming soon!</h1>
<p>Please ignore and/or experiment with anything on this page</p>

<script>

// Build a multidimensional array
var height = 10;
var width = 10;
var num_bombs = 0;


var board = [];

for (var a = 0; a<height; a++) {
	board[a] = [];
	for (var b = 0; b<width; b++) {
		var image = document.createElement("img");
		image.id = "" + a + b;
		image.src = "images/unknown.png";
		image.width = "20";
		image.height = "20";
		image.onclick = onclick;
		image.attr_type = 0;
		image.oncontextmenu = onclick;
		if (Math.floor(Math.random() * 10) == 0) { // One in ten odds
			image.attr_type = "bomb";
			num_bombs ++;
//			console.log(num_bombs);
		}
		board[a][b] = image;
		document.body.appendChild(board[a][b]);
	}
	var br = document.createElement("br");
	document.body.appendChild(br);
}

for (var a = 0; a<height; a++) {
	for (var b = 0; b<width; b++) {
		var square = board[a][b];
		if (square.attr_type === "bomb"){
//			Check the edges
			incrementSquare(a - 1, b);
			incrementSquare(a + 1, b);
			incrementSquare(a, b - 1);
			incrementSquare(a, b + 1);
//			Check the corners
			incrementSquare(a - 1, b - 1);
			incrementSquare(a + 1, b + 1);
			incrementSquare(a - 1, b + 1);
			incrementSquare(a + 1, b - 1);
		}
	}
}

function incrementSquare (a, b) {
	if (board[a] !== undefined) {
		if (board[a][b] !== undefined){
			if (board[a][b].attr_type !== "bomb") {
				board[a][b].attr_type ++;
			}
		}
	}
}



function onclick(e) {
	var unRegex = /unknown\.png/;
	var flRegex = /flag\.png/;

	if (e.button == 0) { // Left click
		console.log("LEFT CLICK");
	} else { // Right click
		console.log("RIGHT CLICK");
		console.log(e.target.currentSrc);
		if (e.target.currentSrc.match(unRegex)) {
			console.log("ITWORKS");
			e.target.src = "images/flag.png";
		} else if (e.target.currentSrc.match(flRegex)) {
			e.target.src = "images/unknown.png";
		}
	}
	return false; // To prevent the context menu from appearing
}
</script>
</body>
</html>